# 議事録修正支援アプリ v2.0 機能要件定義書

## アプリケーション概要

**アプリケーション名**: 議事録修正支援アプリ v2.0  
**開発者**: ZEAL-BOOT-CAMP  
**目的**: 教育・PoC（概念実証）  
**アーキテクチャ**: Electron + React + TypeScript (デスクトップアプリ)  
**対象OS**: Windows 11  
**ビルドシステム**: Vite + tsup  
**パッケージ管理**: npm

## セキュリティ・利用上の注意

**⚠️ 重要**: 本アプリは教育・検証目的で開発されており、機密情報・個人情報の入力は禁止(今後は安全版に展開予定)
- AI APIでの学習利用可能性あり
- 個人情報、社内機密情報は入力不可
- 安全な環境での概念実証用途のみ

## 1. メイン画面（トップページ）機能要件

### 1.1 基本レイアウト
- **2カラムレイアウト**: 左側操作パネル + 右側編集プレビューエリア
- **ヘッダー**: アプリタイトル、ワークフロー表示、メニューボタン群
- **フッター**: コピーライト表示
- **レスポンシブ対応**: 480px以下でモバイル用レイアウトに切り替え

### 1.2 ワークフロー表示
```
📤 入力 → ⚙️ プロンプト → 🤖 AI修正 → ✏️ 編集
```
- 各ステップの完了状態を色分けで表示（pending/active/completed）
- 現在のステップをハイライト表示

### 1.3 ヘッダーメニュー
- **お問い合わせボタン**: ContactModal呼び出し
- **このアプリについてボタン**: AboutModal呼び出し  
- **設定ボタン**: SettingsModal呼び出し
- **モバイル用ハンバーガーメニュー**: 480px以下で表示

## 2. 入力機能（Step 1）要件

### 2.1 ファイルアップロード機能
- **対応形式**: VTTファイル（音声認識結果）
- **ドラッグ&ドロップ**: ファイル領域へのD&D対応
- **ファイル選択**: クリックでファイル選択ダイアログ
- **プレビュー表示**: アップロード後の内容確認
- **VTT解析**: 時刻情報を除去し純粋なテキストを抽出
- **文字数カウント**: リアルタイム文字数表示
- **話者情報保持**: 話者名の識別・保持機能

### 2.2 直接テキスト入力
- **テキストエリア**: 大容量テキスト対応
- **文字数表示**: リアルタイムカウント
- **自動保存**: 2秒間隔での自動保存（localStorage）
- **最終保存時刻表示**: ユーザー確認用

### 2.3 大容量テキスト対応
- **分割処理対応**: 5000文字超過時の自動分割提案
- **分割パラメータ**: 設定画面で調整可能
- **進捗表示**: 分割処理時の進捗可視化

## 3. プロンプト選択機能（Step 2）要件

### 3.1 テンプレート管理
- **プリセットテンプレート**: 
  - 一般的な会議議事録用
  - プロジェクト会議用
  - 技術的な議論用
  - カスタムテンプレート
- **テンプレート編集**: リアルタイム編集・プレビュー
- **データベース保存**: SQLiteでの永続化
- **テンプレート説明**: 各テンプレートの用途説明表示

### 3.2 カスタムプロンプト
- **フリー入力**: 独自プロンプトの作成
- **一時編集**: プレビュー即時反映
- **保存機能**: データベースへの永続保存
- **編集状態表示**: 未保存状態の可視化

## 4. AI修正実行機能（Step 3）要件

### 4.1 モデル選択
- **対応モデル**: 
  - GPT-5（OpenAI）
  - Gemini-2.5-Pro（Google）
  - Gemini-2.0-Flash（Google/デフォルト）
  - Gemini-2.5-Flash（Google）
- **モデル情報表示**: 各モデルの特徴・利用可能性
- **設定連携**: 設定画面で選択したモデルの自動適用

### 4.2 AI処理実行
- **入力検証**: テキスト・プロンプトの必須チェック
- **API選択**: 選択モデルに応じたプロバイダー自動判定
- **分割処理**: 大容量テキストの自動分割・並列処理
- **進捗表示**: 
  ```
  🔄 LLM処理中: 2/5分割完了 残り約45秒 ██████░░░░ 60%
  ```
- **エラーハンドリング**: リトライ・フォールバック機能
- **結果検証**: 出力テキストの妥当性チェック

### 4.3 分割処理詳細
- **チャンク分割**: 設定可能なサイズ（デフォルト5000文字）
- **オーバーラップ**: 内容欠損防止（デフォルト100文字）
- **文単位分割**: 自然な区切りでの分割
- **話者情報保持**: 分割後も話者名を維持
- **結果統合**: 分割結果の自動マージ

## 5. 編集・プレビュー機能（Step 4）要件

### 5.1 編集機能
- **テキストエディタ**: シンプルなtextarea形式エディタ
- **リアルタイム保存**: 編集内容の自動保存（localStorage）
- **文字数表示**: 編集中の文字数リアルタイム表示
- **タブ切り替え**: 編集/プレビューのタブ形式表示

### 5.2 Markdownプレビュー
- **リアルタイムプレビュー**: 編集と同期したプレビュー表示
- **Markdown対応**: 見出し、箇条書き、テーブル等
- **スタイル適用**: 読みやすいプレビュー用CSS
- **タブ切り替え**: 編集/プレビューの切り替え

### 5.3 LLM再修正機能
- **追記・修正指示**: 自然言語での修正指示入力
- **選択モデル連携**: 設定で選択したモデルを自動使用
- **全体修正**: 編集中テキスト全体に対する再修正
- **再修正パネル**: 折りたたみ可能な修正指示入力エリア
- **進捗表示**: 再修正処理中の状態表示

### 5.4 PDF出力機能
- **Markdown→PDF変換**: Chromium印刷機能活用
- **タイトル設定**: PDF出力時のタイトル指定
- **テンプレート変数**: {{TITLE}}等の自動置換
- **ファイル名生成**: タイムスタンプ付き自動命名
- **ダウンロード保存**: Downloadsフォルダへの自動保存
- **PowerShell風操作**: シンプルなファイル操作

## 6. 設定画面機能要件

### 6.1 APIキー管理
- **安全な保存**: SecureStorageでの暗号化保存
- **プロバイダー別設定**:
  - OpenAI API Key（GPT-5用）
  - Google Gemini API Key（Gemini用）
- **接続テスト**: API疎通確認機能
- **環境変数フォールバック**: .env からのキー読み込み

### 6.2 モデル設定
- **利用モデル選択**: プロバイダー別のモデル選択
- **デフォルトモデル指定**: 初期選択モデルの設定
- **モデル情報表示**: 各モデルの性能・特徴説明
- **JSON設定管理**: models.jsonでのモデル管理

### 6.3 分割処理設定
- **分割サイズ設定**: 最大チャンクサイズ（文字数）
- **オーバーラップ設定**: 重複部分のサイズ
- **分割方式選択**: 文単位分割のON/OFF
- **話者情報保持**: 話者名保持機能のON/OFF
- **プレビュー機能**: 設定による分割結果プレビュー

### 6.4 プロンプト管理
- **テンプレート一覧**: プリセットテンプレート表示
- **テンプレート編集**: リアルタイムプレビュー付き編集
- **カスタムプロンプト**: フリー入力での独自プロンプト作成
- **データベース保存**: SQLiteでの永続化（モックデータ併用）

### 6.5 UI設定
- **ダークモード**: テーマ切り替え機能
- **カスタム辞書**: 専門用語辞書のON/OFF
- **自動保存間隔**: 自動保存のタイミング調整
- **言語設定**: 将来的な多言語対応準備

## 7. モーダル画面機能要件

### 7.1 AboutModal（このアプリについて）
- **タブ形式表示**: 「アプリについて」「技術スタック」「今後の実装予定」
- **アプリケーション情報**:
  - 開発者情報（ZEAL-BOOT-CAMP）
  - 目的説明（教育・PoC）
  - 機密情報・個人情報の注意事項
- **技術スタック**:
  - フロントエンド技術（React, TypeScript, Vite）
  - バックエンド技術（Electron, Node.js, SQLite）
  - AI・API技術（OpenAI, Google Gemini）
- **今後の予定**: 機能拡張のロードマップ表示

### 7.2 ContactModal（お問い合わせ）
- **連絡先情報**: 開発者・サポート連絡先
- **フィードバック機能**: 問題報告・要望送信
- **FAQリンク**: よくある質問へのリンク
- **GitHubリンク**: ソースコード・Issue報告用

### 7.3 DictionaryModal（カスタム辞書）
- **辞書エントリ管理**: 用語の追加・編集・削除（基本機能実装済み）
- **カテゴリ分類**: 専門用語の分類管理
- **AI処理連携**: 辞書用語を考慮した修正処理
- **設定連携**: メイン設定でのON/OFF切り替え

### 7.4 SettingsModal（設定画面）
- **タブ形式**: APIキー、モデル設定、分割設定、プロンプト管理、UI設定
- **リアルタイム同期**: 設定変更の即座反映
- **データ永続化**: SecureStorage + localStorage併用

## 8. データ管理・永続化要件

### 8.1 ローカルストレージ
- **自動保存データ**: 入力テキスト、編集内容
- **UI状態**: ダークモード、選択テンプレート等
- **設定情報**: 非機密設定項目

### 8.2 SQLiteデータベース
- **テンプレート管理**: プロンプトテンプレートの保存
- **履歴管理**: 処理履歴の記録
- **メタデータ**: ファイル情報、処理ログ

### 8.3 セキュアストレージ
- **APIキー**: 暗号化されたAPIキー保存
- **機密設定**: セキュリティが必要な設定項目

## 9. パフォーマンス要件

### 9.1 応答性能
- **初期起動時間**: 3秒以内
- **UI応答**: 100ms以内のレスポンス
- **ファイル読み込み**: 10MB以内のファイルを2秒以内で処理

### 9.2 メモリ使用量
- **基本動作**: 200MB以下
- **大容量処理**: 1GB以下（100万文字処理時）

### 9.3 分割処理効率
- **並列処理**: 最大5並列でのAPI呼び出し
- **エラー回復**: 3回までの自動リトライ
- **レート制限対応**: API制限に応じた待機制御

## 10. セキュリティ要件

### 10.1 データ保護
- **APIキー暗号化**: AES暗号化での保存
- **ローカル処理**: 機密データはローカルのみで処理
- **通信暗号化**: HTTPS通信の強制

### 10.2 Electronセキュリティ
- **コンテキスト分離**: レンダラープロセスの分離
- **ノード統合無効**: セキュリティポリシー適用
- **CSP設定**: Content Security Policyの適用

## 11. エラーハンドリング要件

### 11.1 ユーザーフレンドリーなエラー表示
- **トースト通知**: 非侵入的なエラー通知
- **詳細メッセージ**: 具体的な対応方法の提示
- **復旧手順**: 自動復旧・手動復旧の案内

### 11.2 ログ管理
- **デバッグログ**: 開発用詳細ログ
- **エラーログ**: 問題調査用ログ保存
- **パフォーマンスログ**: 処理時間等の記録

## 12. 将来拡張要件

### 12.1 多言語対応
- **i18n準備**: 国際化対応の基盤整備
- **UI文言管理**: 外部ファイルでの文言管理

### 12.2 プラグイン機能
- **カスタムプロセッサ**: ユーザー定義処理の追加
- **テーマ機能**: カスタムテーマの対応

### 12.3 クラウド連携
- **設定同期**: 複数デバイス間での設定共有
- **テンプレート共有**: コミュニティテンプレートの共有

## 13. 実装状況・制約事項

### 13.1 完全実装済み機能
- ✅ **基本UI**: ダッシュボード、レスポンシブデザイン、モバイル対応
- ✅ **ファイルアップロード**: VTT解析、文字数カウント、D&D対応
- ✅ **AI処理**: GPT-5, Gemini 2.5 Pro, Gemini 2.0 Flash対応
- ✅ **分割処理**: 大容量テキストの自動分割・並列処理・進捗表示
- ✅ **プロンプト管理**: テンプレート選択・編集・カスタムプロンプト
- ✅ **編集・プレビュー**: Markdown編集、リアルタイムプレビュー
- ✅ **LLM再修正**: 設定モデル連携、自然言語修正指示
- ✅ **PDF出力**: テンプレート変数処理、自動ダウンロード
- ✅ **設定管理**: APIキー暗号化、モデル設定、UI同期
- ✅ **データ永続化**: SQLite, SecureStorage, localStorage

### 13.2 部分実装・制約のある機能
- ⚠️ **カスタム辞書**: 基本機能のみ、AI連携は限定的
- ⚠️ **履歴管理**: 一部実装、完全な履歴比較機能は未完成
- ⚠️ **エラー回復**: リトライ機能あり、詳細なエラー分析は限定的

### 13.3 未実装・将来実装予定
- 🔄 **多言語対応**: i18n基盤未実装
- 🔄 **プラグイン機能**: 拡張機能システム未実装  
- 🔄 **クラウド連携**: 全て未実装
- 🔄 **詳細ログ管理**: 基本ログのみ、分析機能未実装

---

**更新履歴**:
- v1.0: 初版作成（2025-08-30）
- v2.0: VTT分割処理機能追加、UI刷新（2025-08-30）
- v2.1: 実装状況に基づく要件定義更新（2025-08-30）

**作成者**: Claude (Anthropic)  
**レビュー**: 実装コードベース照合済み  
**文書バージョン**: 2.1.0