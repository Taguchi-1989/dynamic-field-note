# デプロイ前チェックリスト

**プロジェクト**: Dynamic Field Note
**作成日**: 2025-10-18

---

## 📋 デプロイ前の必須チェック項目

このチェックリストは、本番環境へのデプロイ前に実行すべき項目です。
すべての項目が ✅ になっていることを確認してください。

---

## 1. コード品質チェック

### 1.1 TypeScript 型チェック

```bash
npm run type-check
```

- [ ] エラーなし
- [ ] 警告なし

### 1.2 ESLint チェック

```bash
npm run lint
```

- [ ] エラーなし
- [ ] 警告なし（`--max-warnings 0`）

### 1.3 Prettier フォーマットチェック

```bash
npm run format:check
```

- [ ] すべてのファイルがフォーマット済み

### 1.4 統合バリデーション

```bash
npm run validate
```

- [ ] すべてのチェックがパス

---

## 2. テスト実行

### 2.1 スモークテスト（必須）

```bash
npm run test:smoke
```

- [ ] すべてのテストがパス
- [ ] 実行時間: ~3 分以内

### 2.2 包括的 E2E テスト（推奨）

```bash
npm run test:comprehensive
```

- [ ] すべてのテストがパス
- [ ] カバレッジ 70%以上
- [ ] 実行時間: ~10-15 分

---

## 3. セキュリティチェック

### 3.1 依存関係の脆弱性スキャン

```bash
npm audit --audit-level=moderate
```

- [ ] Critical 脆弱性なし
- [ ] High 脆弱性なし
- [ ] Moderate 脆弱性は評価済み

### 3.2 既知の脆弱性の確認

**現在の既知の脆弱性**:

- markdown-it < 12.3.2 (Moderate)
  - 影響範囲: AI 生成コンテンツのみ
  - リスク評価: 低（信頼できるソースのみ）
  - 対応: Dependabot で監視中

---

## 4. コードの静的解析

### 4.1 循環依存チェック

```bash
npx madge --circular --extensions ts,tsx src/
```

- [ ] 循環依存なし

### 4.2 未使用コード検出

```bash
npx ts-prune --error || true
npx depcheck || true
```

- [ ] 未使用エクスポートを確認
- [ ] Phase 3+用の予約コードは除外

---

## 5. ビルドチェック

### 5.1 開発ビルド

```bash
npm start
```

- [ ] エラーなく起動
- [ ] ホーム画面が正常に表示
- [ ] 基本機能が動作

### 5.2 本番ビルド（Expo）

```bash
# Android
expo build:android

# iOS
expo build:ios
```

- [ ] ビルドエラーなし
- [ ] アプリサイズが適切（< 50MB）
- [ ] 起動時間が適切（< 3 秒）

---

## 6. 機能テスト

### 6.1 Phase 1 機能

- [ ] 音声バッファ管理が動作
- [ ] Gemini API 連携が動作
- [ ] Markdown 生成が正常

### 6.2 Phase 2 機能

- [ ] Markdown プレビューが正常に表示
- [ ] FAB 要約ボタンが動作
- [ ] Drawer ナビゲーションが動作
- [ ] AI 状態インジケーターが表示
- [ ] アクセシビリティ設定が動作
  - [ ] フォントサイズ変更
  - [ ] ダークモード（無効状態）

---

## 7. パフォーマンスチェック

### 7.1 メモリ使用量

- [ ] アイドル時: < 100MB
- [ ] 要約実行中: < 200MB
- [ ] メモリリークなし

### 7.2 レスポンス時間

- [ ] アプリ起動: < 3 秒
- [ ] 画面遷移: < 500ms
- [ ] Gemini API: < 5 秒（ネットワーク依存）

---

## 8. ドキュメント確認

### 8.1 README.md

- [ ] Phase 2 完了が記載されている
- [ ] インストール手順が最新
- [ ] スクリーンショットが最新

### 8.2 技術ドキュメント

- [ ] `docs/phase2-improvements.md` が最新
- [ ] `docs/static-analysis-report.md` が最新
- [ ] `docs/e2e-testing.md` が最新

---

## 9. Git 管理

### 9.1 コミット状態

- [ ] すべての変更がコミット済み
- [ ] コミットメッセージが適切
- [ ] 不要なファイルが含まれていない

### 9.2 ブランチ管理

- [ ] 適切なブランチで作業
- [ ] main/develop にマージ前
- [ ] 競合解決済み

---

## 10. CI/CD 確認

### 10.1 GitHub Actions

- [ ] すべてのワークフローがパス
- [ ] E2E スモークテストがパス
- [ ] 品質チェックがパス

### 10.2 テスト結果

- [ ] カバレッジレポート確認
- [ ] テスト結果アーティファクト確認

---

## 11. 環境変数・設定

### 11.1 Gemini API キー

- [ ] `.env.local` に設定済み
- [ ] `.env` はコミットされていない
- [ ] `.gitignore` に `.env.local` が含まれている

### 11.2 設定ファイル

- [ ] `package.json` のバージョンが適切
- [ ] `app.json` の設定が適切

---

## 12. デプロイ手順

### 12.1 デプロイ前の最終確認

```bash
# すべてのチェックを一度に実行
npm run validate && npm run test:smoke
```

- [ ] すべてのチェックがパス

### 12.2 デプロイ実行

```bash
# 本番ビルド
expo build:android  # または expo build:ios

# デプロイ
# （プロジェクト固有のデプロイコマンド）
```

- [ ] デプロイ成功
- [ ] 本番環境で動作確認

### 12.3 デプロイ後の確認

- [ ] アプリが正常に起動
- [ ] 主要機能が動作
- [ ] エラーログなし

---

## 13. ロールバック準備

### 13.1 バックアップ

- [ ] 前バージョンのビルドを保持
- [ ] データベース（Phase 3+）のバックアップ

### 13.2 ロールバック手順

```bash
# 問題が発生した場合
git revert <commit-hash>
# または
git reset --hard <previous-commit>
```

- [ ] ロールバック手順を確認
- [ ] 緊急連絡先を確認

---

## 14. 完了確認

### 14.1 チェックリスト完了

- [ ] すべての項目が ✅
- [ ] デプロイ担当者が確認
- [ ] レビュアーが承認

### 14.2 デプロイログ

**デプロイ日時**: \_\_\_\_/\_\_\_\_/\_\_\_\_

**デプロイ担当者**: \_\_\_\_\_\_\_\_\_\_\_\_\_\_

**レビュアー**: \_\_\_\_\_\_\_\_\_\_\_\_\_\_

**バージョン**: \_\_\_\_\_\_\_\_\_\_\_\_\_\_

**備考**:

---

## ⚠️ 注意事項

1. **すべての項目が ✅ になるまでデプロイしない**
2. **問題が見つかった場合は修正してから再チェック**
3. **デプロイ後は必ず本番環境で動作確認**
4. **問題が発生した場合はすぐにロールバック**

---

## 📞 緊急連絡先

**技術担当**: \_\_\_\_\_\_\_\_\_\_\_\_\_\_

**プロジェクトマネージャー**: \_\_\_\_\_\_\_\_\_\_\_\_\_\_

**エスカレーション先**: \_\_\_\_\_\_\_\_\_\_\_\_\_\_

---

**このチェックリストを完了したら、自信を持ってデプロイしてください！** 🚀
