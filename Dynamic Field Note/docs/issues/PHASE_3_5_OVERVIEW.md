# Phase 3.5: å†™çœŸã‚µãƒ ãƒã‚¤ãƒ«æ©Ÿèƒ½ - å®Ÿè£…ç®¡ç†

**ä½œæˆæ—¥**: 2025-10-18
**ãƒ•ã‚§ãƒ¼ã‚º**: Phase 3.5 - å†™çœŸã‚µãƒ ãƒã‚¤ãƒ«æ©Ÿèƒ½
**ç·å·¥æ•°è¦‹ç©**: 13-18æ™‚é–“

---

## ğŸ“‹ æ¦‚è¦

Dynamic Field Noteã«å†™çœŸã‚µãƒ ãƒã‚¤ãƒ«æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã€ç¾å ´å ±å‘Šæ›¸ã«å†™çœŸã‚’æ·»ä»˜ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

### ä¸»ãªæ©Ÿèƒ½

1. **ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæœ€é©åŒ–** - éŸ³å£°å…¥åŠ›æ¬„ã‚’åºƒã
2. **å†™çœŸæ’®å½±â†’ã‚µãƒ ãƒã‚¤ãƒ«è¡¨ç¤º** - ã‚«ãƒ¡ãƒ©æ’®å½±å¾Œã€HomeScreenä¸‹éƒ¨ã«ã‚µãƒ ãƒã‚¤ãƒ«è¡¨ç¤º
3. **å†™çœŸå‰Šé™¤** - ã‚µãƒ ãƒã‚¤ãƒ«å³ä¸Šã®Ã—ãƒœã‚¿ãƒ³ã§å‰Šé™¤ï¼ˆç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ä»˜ãï¼‰
4. **å†™çœŸæ‹¡å¤§è¡¨ç¤º** - ã‚µãƒ ãƒã‚¤ãƒ«ã‚¿ãƒƒãƒ—ã§æ‹¡å¤§ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º
5. **å ±å‘Šæ›¸çµ±åˆ** - å ±å‘Šæ›¸ä¿å­˜æ™‚ã€Markdownã«å†™çœŸãƒ‘ã‚¹åŸ‹ã‚è¾¼ã¿

---

## ğŸ¯ ç¢ºå®šä»•æ§˜

| é …ç›®                 | ä»•æ§˜                                         |
| -------------------- | -------------------------------------------- |
| **å†™çœŸä¸Šé™**         | 10 æš/å ±å‘Šæ›¸                                 |
| **ã‚µãƒ ãƒã‚¤ãƒ«ã‚µã‚¤ã‚º** | 200x200px                                    |
| **å†™çœŸå‰Šé™¤**         | è«–ç†å‰Šé™¤ï¼ˆis_deleted = 1ï¼‰                   |
| **æ¡ˆä»¶ã¨ã®ç´ä»˜ã‘**   | æ¡ˆä»¶ï¼ˆCaseï¼‰ã«ç´ä»˜ã‘ã‚‹                       |
| **å ±å‘Šæ›¸æ·»ä»˜**       | å ±å‘Šæ›¸ï¼ˆReportï¼‰ã«å†™çœŸã‚’æ·»ä»˜                 |
| **æ‹¡å¤§è¡¨ç¤º**         | ã‚¿ãƒƒãƒ—ã§æ‹¡å¤§ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º                     |
| **ç·¨é›†æ©Ÿèƒ½**         | Phase 3.5 ã§ã¯å®Ÿè£…ã—ãªã„ï¼ˆæ³¨é‡ˆæ©Ÿèƒ½ã¯æœªä½¿ç”¨ï¼‰ |
| **ã‚«ãƒ¡ãƒ©æ’®å½±å¾Œ**     | HomeScreen ã«è‡ªå‹•é·ç§»                        |

---

## ğŸ“ ã‚¤ã‚·ãƒ¥ãƒ¼ä¸€è¦§

### é€²æ—çŠ¶æ³

| Issue  | ã‚¿ã‚¤ãƒˆãƒ«           | å„ªå…ˆåº¦ | å·¥æ•° | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | ä¾å­˜   |
| ------ | ------------------ | ------ | ---- | ---------- | ------ |
| #3.5.1 | ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæœ€é©åŒ–   | MEDIUM | 1-2h | TODO       | -      |
| #3.5.2 | å†™çœŸã‚µãƒ ãƒã‚¤ãƒ«åŸºç›¤ | HIGH   | 5-6h | TODO       | -      |
| #3.5.3 | å†™çœŸå‰Šé™¤æ©Ÿèƒ½       | HIGH   | 2-3h | TODO       | #3.5.2 |
| #3.5.4 | å†™çœŸæ‹¡å¤§è¡¨ç¤º       | MEDIUM | 2-3h | TODO       | #3.5.2 |
| #3.5.5 | å ±å‘Šæ›¸çµ±åˆ         | HIGH   | 3-4h | TODO       | #3.5.2 |

**ç·å·¥æ•°**: 13-18 æ™‚é–“

---

## ğŸ”„ å®Ÿè£…é †åº

```mermaid
graph TD
    A[#3.5.1 ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæœ€é©åŒ–] --> B[#3.5.2 å†™çœŸã‚µãƒ ãƒã‚¤ãƒ«åŸºç›¤]
    B --> C[#3.5.3 å†™çœŸå‰Šé™¤æ©Ÿèƒ½]
    B --> D[#3.5.4 å†™çœŸæ‹¡å¤§è¡¨ç¤º]
    B --> E[#3.5.5 å ±å‘Šæ›¸çµ±åˆ]

    C --> F[Phase 3.5 å®Œäº†]
    D --> F
    E --> F
```

**æ¨å¥¨é †åº**:

1. **#3.5.1** - ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæœ€é©åŒ–ï¼ˆç‹¬ç«‹ä½œæ¥­ï¼‰
2. **#3.5.2** - å†™çœŸã‚µãƒ ãƒã‚¤ãƒ«åŸºç›¤ï¼ˆæœ€é‡è¦ï¼‰
3. **#3.5.3** - å†™çœŸå‰Šé™¤æ©Ÿèƒ½ï¼ˆ#3.5.2 ä¾å­˜ï¼‰
4. **#3.5.4** - å†™çœŸæ‹¡å¤§è¡¨ç¤ºï¼ˆ#3.5.2 ä¾å­˜ï¼‰
5. **#3.5.5** - å ±å‘Šæ›¸çµ±åˆï¼ˆ#3.5.2 ä¾å­˜ï¼‰

---

## ğŸ“¦ æ–°è¦ä½œæˆãƒ•ã‚¡ã‚¤ãƒ«

### ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯

- [x] `src/hooks/usePhotoManager.ts` (100-150 è¡Œ)

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

- [x] `src/components/PhotoThumbnailGrid.tsx` (150-200 è¡Œ)
- [x] `src/components/PhotoViewerModal.tsx` (80-100 è¡Œ)

### ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£

- [x] `src/utils/imageUtils.ts` (30-50 è¡Œ)
- [x] `src/utils/reportUtils.ts` (50-80 è¡Œ)

### ãƒ†ã‚¹ãƒˆ

- [x] `src/hooks/__tests__/usePhotoManager.test.ts` (15-20 ä»¶)
- [x] `src/components/__tests__/PhotoThumbnailGrid.test.ts` (15-20 ä»¶)
- [x] `src/components/__tests__/PhotoViewerModal.test.ts` (8-10 ä»¶)

---

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### æ—¢å­˜ã®ä½¿ç”¨

- âœ… expo-cameraï¼ˆå†™çœŸæ’®å½±ï¼‰
- âœ… expo-file-systemï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ï¼‰
- âœ… expo-sqliteï¼ˆPhotoDAOï¼‰
- âœ… react-native-paperï¼ˆUI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰

### æ–°è¦è¿½åŠ 

- [ ] expo-image-manipulatorï¼ˆã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆï¼‰

```bash
npm install expo-image-manipulator
```

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### å†™çœŸè¿½åŠ ãƒ•ãƒ­ãƒ¼

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œå†™çœŸã€ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—
   â†“
2. CameraScreen ã«é·ç§»
   â†“
3. å†™çœŸæ’®å½±ï¼ˆtakePictureAsyncï¼‰
   â†“
4. HomeScreen ã«æˆ»ã‚‹ï¼ˆnavigation.navigate('Home', { photoUri })ï¼‰
   â†“
5. usePhotoManager.addPhoto(uri) å®Ÿè¡Œ
   â†“
6. ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆï¼ˆimageUtils.generateThumbnailï¼‰
   â†“
7. PhotoDAO.create({ file_path, thumbnail_path, ... })
   â†“
8. photos state æ›´æ–°
   â†“
9. PhotoThumbnailGrid å†æç”»
```

### å†™çœŸå‰Šé™¤ãƒ•ãƒ­ãƒ¼

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚µãƒ ãƒã‚¤ãƒ«å³ä¸Šã®Ã—ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—
   â†“
2. å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º
   â†“
3. ã€Œã¯ã„ã€ã‚’ã‚¿ãƒƒãƒ—
   â†“
4. PhotoDAO.delete(id) - is_deleted = 1
   â†“
5. photos state ã‹ã‚‰å‰Šé™¤
   â†“
6. PhotoThumbnailGrid å†æç”»
```

### å ±å‘Šæ›¸ä¿å­˜ãƒ•ãƒ­ãƒ¼

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå ±å‘Šæ›¸ã‚’ä¿å­˜
   â†“
2. ReportDAO.create({ content: markdownWithPhotos, ... })
   â†“
3. å†™çœŸã® report_id æ›´æ–°ï¼ˆPhotoDAO.updateï¼‰
   â†“
4. ãƒ•ã‚¡ã‚¤ãƒ«æ•´ç†ï¼ˆreports/report_XXX/photos/ï¼‰
   â†“
5. Markdown ã«å†™çœŸãƒ‘ã‚¹åŸ‹ã‚è¾¼ã¿
   â†“
6. å®Œäº†
```

---

## âœ… å®Œäº†åŸºæº–

### æ©Ÿèƒ½è¦ä»¶

- [x] éŸ³å£°å…¥åŠ›æ¬„ãŒ1ç”»é¢ã«åã¾ã‚‹ç¯„å›²ã§æœ€å¤§é™åºƒã„
- [x] å†™çœŸ10æšã¾ã§è¿½åŠ å¯èƒ½
- [x] ã‚µãƒ ãƒã‚¤ãƒ«è¡¨ç¤ºï¼ˆæ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼‰
- [x] ã‚¿ãƒƒãƒ—ã§æ‹¡å¤§è¡¨ç¤º
- [x] Ã—ãƒœã‚¿ãƒ³ã§å‰Šé™¤ï¼ˆç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼‰
- [x] ã‚«ãƒ¡ãƒ©æ’®å½±å¾Œã€HomeScreenã«è‡ªå‹•é·ç§»
- [x] å ±å‘Šæ›¸ä¿å­˜æ™‚ã€Markdownã«å†™çœŸãƒ‘ã‚¹åŸ‹ã‚è¾¼ã¿
- [x] æ¡ˆä»¶ï¼ˆCaseï¼‰ã«å†™çœŸã‚’ç´ä»˜ã‘
- [x] å ±å‘Šæ›¸ï¼ˆReportï¼‰ã«å†™çœŸã‚’æ·»ä»˜

### å“è³ªè¦ä»¶

- [x] TypeScript: 0 ã‚¨ãƒ©ãƒ¼ï¼ˆstrict modeï¼‰
- [x] ESLint: 0 è­¦å‘Šï¼ˆmax-warnings: 0ï¼‰
- [x] Prettier: 100% æº–æ‹ 
- [x] Tests: å…¨ãƒ†ã‚¹ãƒˆãƒ‘ã‚¹ï¼ˆ48-60 ä»¶ï¼‰
- [x] Smoke Tests: å®Ÿè¡Œæ™‚é–“ < 1 åˆ†
- [x] ã‚¬ãƒ¼ãƒ‰ãƒ¬ãƒ¼ãƒ«: å…¨ãƒ‘ã‚¹

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### ã‚¤ã‚·ãƒ¥ãƒ¼è©³ç´°

- [Issue #3.5.1 - ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæœ€é©åŒ–](./PHASE_3_5_1_LAYOUT_OPTIMIZATION.md)
- [Issue #3.5.2 - å†™çœŸã‚µãƒ ãƒã‚¤ãƒ«åŸºç›¤](./PHASE_3_5_2_PHOTO_THUMBNAIL_INTEGRATION.md)
- [Issue #3.5.3 - å†™çœŸå‰Šé™¤æ©Ÿèƒ½](./PHASE_3_5_3_PHOTO_DELETE_FUNCTION.md)
- [Issue #3.5.4 - å†™çœŸæ‹¡å¤§è¡¨ç¤º](./PHASE_3_5_4_PHOTO_VIEWER_MODAL.md)
- [Issue #3.5.5 - å ±å‘Šæ›¸çµ±åˆ](./PHASE_3_5_5_REPORT_PHOTO_INTEGRATION.md)

### æŠ€è¡“ä»•æ§˜

- [SQLite ã‚¹ã‚­ãƒ¼ãƒ](../sqlite-schema.md) - photos ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©
- [PhotoDAO](../../src/dao/PhotoDAO.ts) - CRUD æ“ä½œ
- [Case å‹å®šç¾©](../../src/types/case.ts) - Photo ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

---

## ğŸš€ GitHubã‚¤ã‚·ãƒ¥ãƒ¼ç™»éŒ²

å„ã‚¤ã‚·ãƒ¥ãƒ¼ã‚’ GitHub Issues ã«ç™»éŒ²ã™ã‚‹å ´åˆï¼š

```bash
# gh CLIä½¿ç”¨ä¾‹
gh issue create \
  --title "[Phase 3.5.1] éŸ³å£°å…¥åŠ›æ¬„ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæœ€é©åŒ–" \
  --body-file docs/issues/PHASE_3_5_1_LAYOUT_OPTIMIZATION.md \
  --label "phase-3,enhancement" \
  --assignee @me

gh issue create \
  --title "[Phase 3.5.2] å†™çœŸã‚µãƒ ãƒã‚¤ãƒ«åŸºç›¤" \
  --body-file docs/issues/PHASE_3_5_2_PHOTO_THUMBNAIL_INTEGRATION.md \
  --label "phase-3,feature,high-priority" \
  --assignee @me

# ... ä»¥ä¸‹åŒæ§˜
```

ã¾ãŸã¯ GitHub UI ã‹ã‚‰æ‰‹å‹•ã§ä½œæˆã—ã€å„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆã€‚

---

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**: [Issue #3.5.1 ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæœ€é©åŒ–](./PHASE_3_5_1_LAYOUT_OPTIMIZATION.md) ã‹ã‚‰å®Ÿè£…é–‹å§‹
